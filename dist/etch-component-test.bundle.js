(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.TinyEmitter = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
function E () {
	// Keep this empty so it's easier to inherit from
  // (via https://github.com/lipsmack from https://github.com/scottcorgan/tiny-emitter/issues/3)
}

E.prototype = {
	on: function (name, callback, ctx) {
    var e = this.e || (this.e = {});

    (e[name] || (e[name] = [])).push({
      fn: callback,
      ctx: ctx
    });

    return this;
  },

  once: function (name, callback, ctx) {
    var self = this;
    function listener () {
      self.off(name, listener);
      callback.apply(ctx, arguments);
    };

    listener._ = callback
    return this.on(name, listener, ctx);
  },

  emit: function (name) {
    var data = [].slice.call(arguments, 1);
    var evtArr = ((this.e || (this.e = {}))[name] || []).slice();
    var i = 0;
    var len = evtArr.length;

    for (i; i < len; i++) {
      evtArr[i].fn.apply(evtArr[i].ctx, data);
    }

    return this;
  },

  off: function (name, callback) {
    var e = this.e || (this.e = {});
    var evts = e[name];
    var liveEvents = [];

    if (evts && callback) {
      for (var i = 0, len = evts.length; i < len; i++) {
        if (evts[i].fn !== callback && evts[i].fn._ !== callback)
          liveEvents.push(evts[i]);
      }
    }

    // Remove event from queue to prevent memory leak
    // Suggested by https://github.com/lazd
    // Ref: https://github.com/scottcorgan/tiny-emitter/commit/c6ebfaa9bc973b33d110a84a307742b7cf94c953#commitcomment-5024910

    (liveEvents.length)
      ? e[name] = liveEvents
      : delete e[name];

    return this;
  }
};

module.exports = E;

},{}]},{},[1])(1)
});
!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.baseComponent=f()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){var _Components;!function(_Components){function applyMixins(derivedCtor,baseCtors){baseCtors.forEach(function(baseCtor){Object.getOwnPropertyNames(baseCtor.prototype).forEach(function(name){derivedCtor.prototype[name]=baseCtor.prototype[name]})})}var BaseComponent=function(){function BaseComponent(options){this.options=$.extend(this._getDefaultOptions(),options)}return BaseComponent.prototype._init=function(){return this._$element=$(this.options.element),this._$element.length?(this._$element.empty(),!0):(console.warn("element not found"),!1)},BaseComponent.prototype._getDefaultOptions=function(){return{}},BaseComponent.prototype._emit=function(event){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];this.emit(event,args)},BaseComponent.prototype._resize=function(){},BaseComponent.prototype.databind=function(data){},BaseComponent}();_Components.BaseComponent=BaseComponent,_Components.applyMixins=applyMixins,applyMixins(BaseComponent,[TinyEmitter])}(_Components||(_Components={})),function(w){w._Components||(w._Components=_Components)}(window)},{}]},{},[1])(1)});
// extensions v0.1.9 https://github.com/edsilv/extensions
if (!Array.prototype.clone) {
    Array.prototype.clone = function () {
        return this.slice(0);
    };
}
if (!Array.prototype.contains) {
    Array.prototype.contains = function (val) {
        return this.indexOf(val) !== -1;
    };
}
if (!Array.prototype.indexOf) {
    Array.prototype.indexOf = function (searchElement, fromIndex) {
        var i = (fromIndex || 0);
        var j = this.length;
        for (i; i < j; i++) {
            if (this[i] === searchElement) {
                return i;
            }
        }
        return -1;
    };
}
Array.prototype.indexOfTest = function (test, fromIndex) {
    var i = (fromIndex || 0);
    var j = this.length;
    for (i; i < j; i++) {
        if (test(this[i]))
            return i;
    }
    return -1;
};
Array.prototype.insert = function (item, index) {
    this.splice(index, 0, item);
};
if (!Array.prototype.last) {
    Array.prototype.last = function () {
        return this[this.length - 1];
    };
}
Array.prototype.move = function (fromIndex, toIndex) {
    this.splice(toIndex, 0, this.splice(fromIndex, 1)[0]);
};
Array.prototype.remove = function (item) {
    var index = this.indexOf(item);
    if (index > -1) {
        this.splice(index, 1);
    }
};
Array.prototype.removeAt = function (index) {
    this.splice(index, 1);
};
Math.clamp = function (value, min, max) {
    return Math.min(Math.max(value, min), max);
};
Math.constrain = function (value, low, high) {
    return Math.clamp(value, low, high);
};
Math.degreesToRadians = function (degrees) {
    return Math.TAU * (degrees / 360);
};
Math.distanceBetween = function (x1, y1, x2, y2) {
    return Math.sqrt(Math.sq(x2 - x1) + Math.sq(y2 - y1));
};
Math.lerp = function (start, stop, amount) {
    return start + (stop - start) * amount;
};
Math.mag = function (a, b, c) {
    return Math.sqrt(a * a + b * b + c * c);
};
Math.map = function (value, start1, stop1, start2, stop2) {
    return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
};
Math.median = function (values) {
    values.sort(function (a, b) {
        return a - b;
    });
    var half = Math.floor(values.length / 2);
    if (values.length % 2) {
        return values[half];
    }
    else {
        return (values[half - 1] + values[half]) / 2.0;
    }
};
Math.normalise = function (num, min, max) {
    return (num - min) / (max - min);
};
Math.radiansToDegrees = function (radians) {
    return (radians * 360) / Math.TAU;
};
/**
 * Get a random number between two numbers.
 * If 'high' isn't passed, get a number from 0 to 'low'.
 * @param {Number} low The low number.
 * @param {Number} [high] The high number.
 */
Math.randomBetween = function (low, high) {
    if (!high) {
        high = low;
        low = 0;
    }
    if (low >= high)
        return low;
    return low + (high - low) * Math.random();
};
Math.roundToDecimalPlace = function (num, dec) {
    return Math.round(num * Math.pow(10, dec)) / Math.pow(10, dec);
};
Math.sq = function (n) {
    return n * n;
};
Math.TAU = Math.PI * 2;
if (!Number.prototype.isInteger) {
    Number.prototype.isInteger = function () {
        return this % 1 === 0;
    };
}
// Object.create Partial Polyfill
// Support for second parameter is non-standard
if (typeof Object.create !== 'function') {
    Object.create = function (o, props) {
        // Create new object whose prototype is o
        function F() {
        }
        F.prototype = o;
        var result = new F();
        // Copy properties of second parameter into new object
        if (typeof (props) === "object") {
            for (var prop in props) {
                if (props.hasOwnProperty((prop))) {
                    // Even though we don't support all of the functionality that the second
                    // parameter would normally have, we respect the format for the object
                    // passed as that second parameter its specification.
                    result[prop] = props[prop].value;
                }
            }
        }
        // Return new object
        return result;
    };
}
/**
 * Polyfill for Object.keys
 *
 * @see: https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/keys
 */
if (!Object.keys) {
    Object.keys = (function () {
        var hasOwnProperty = Object.prototype.hasOwnProperty, hasDontEnumBug = !({ toString: null }).propertyIsEnumerable('toString'), dontEnums = [
            'toString',
            'toLocaleString',
            'valueOf',
            'hasOwnProperty',
            'isPrototypeOf',
            'propertyIsEnumerable',
            'constructor'
        ], dontEnumsLength = dontEnums.length;
        return function (obj) {
            if (typeof obj !== 'object' && typeof obj !== 'function' || obj === null)
                throw new TypeError('Object.keys called on non-object');
            var result = [];
            for (var prop in obj) {
                if (hasOwnProperty.call(obj, prop))
                    result.push(prop);
            }
            if (hasDontEnumBug) {
                for (var i = 0; i < dontEnumsLength; i++) {
                    if (hasOwnProperty.call(obj, dontEnums[i]))
                        result.push(dontEnums[i]);
                }
            }
            return result;
        };
    })();
}
;
String.prototype.b64_to_utf8 = function () {
    return decodeURIComponent(escape(window.atob(this)));
};
String.prototype.contains = function (str) {
    return this.indexOf(str) !== -1;
};
if (!String.prototype.endsWith) {
    String.prototype.endsWith = function (str) {
        return this.indexOf(str, this.length - str.length) !== -1;
    };
}
String.format = function () {
    var s = arguments[0];
    for (var i = 0; i < arguments.length - 1; i++) {
        var reg = new RegExp("\\{" + i + "\\}", "gm");
        s = s.replace(reg, arguments[i + 1]);
    }
    return s;
};
String.prototype.hashCode = function () {
    var hash = 0, i, chr, len;
    if (this.length === 0)
        return hash.toString();
    for (i = 0, len = this.length; i < len; i++) {
        chr = this.charCodeAt(i);
        hash = ((hash << 5) - hash) + chr;
        hash |= 0; // Convert to 32bit integer
    }
    return hash.toString();
};
String.prototype.isAlphanumeric = function () {
    return /^[a-zA-Z0-9]*$/.test(this);
};
String.prototype.ltrim = function () {
    return this.replace(/^\s+/, '');
};
String.prototype.rtrim = function () {
    return this.replace(/\s+$/, '');
};
if (!String.prototype.startsWith) {
    String.prototype.startsWith = function (str) {
        return this.indexOf(str) == 0;
    };
}
String.prototype.toCssClass = function () {
    return this.replace(/[^a-z0-9]/g, function (s) {
        var c = s.charCodeAt(0);
        if (c == 32)
            return '-';
        if (c >= 65 && c <= 90)
            return '_' + s.toLowerCase();
        return '__' + ('000' + c.toString(16)).slice(-4);
    });
};
String.prototype.toFileName = function () {
    return this.replace(/[^a-z0-9]/gi, '_').toLowerCase();
};
if (!String.prototype.trim) {
    String.prototype.trim = function () {
        return this.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
    };
}
String.prototype.utf8_to_b64 = function () {
    return window.btoa(unescape(encodeURIComponent(this)));
};

var nullstone;!function(t){t.version="0.4.8"}(nullstone||(nullstone={}));var nullstone;!function(t){function e(e,n,r,i){var o=e,s=o.$$annotations;s||Object.defineProperty(o,"$$annotations",{value:s=[],writable:!1});var u=s[n];if(u||(s[n]=u=[]),i&&u.length>0)throw new Error("Only 1 '"+n+"' annotation allowed per type ["+t.getTypeName(e)+"].");u.push(r)}function n(t,e){var n=t,r=n.$$annotations;return r?(r[e]||[]).slice(0):void 0}function r(t){function r(n){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];for(var o=0,s=r.length;s>o;o++)e(n,t,r[o])}return r.Get=function(e){return n(e,t)},r}t.Annotation=e,t.GetAnnotations=n,t.CreateTypedAnnotation=r}(nullstone||(nullstone={}));var nullstone;!function(t){function e(e,n){if(e&&e.constructor===n)return e;var r=o[n];if(r)return r(e);if(n instanceof t.Enum){var i=n.Object;return i.Converter?i.Converter(e):(e=e||0,"string"==typeof e?i[e]:e)}return e}function n(t,e){return t?e[t]:0}function r(t,e){o[t]=e}function i(t,e){t.Converter=e}var o=[];o[Boolean]=function(t){if(null==t)return null;if("boolean"==typeof t)return t;if("number"==typeof t)return 0!==t;var e=t.toString().toUpperCase();return"TRUE"===e?!0:"FALSE"===e?!1:null},o[String]=function(t){return null==t?"":t.toString()},o[Number]=function(t){return t?"number"==typeof t?t:"boolean"==typeof t?t?1:0:parseFloat(t.toString()):0},o[Date]=function(t){return null==t?new Date(0):new Date(t.toString())},o[RegExp]=function(t){if(t instanceof RegExp)return t;if(t=null)throw new Error("Cannot specify an empty RegExp.");return t=t.toString(),new RegExp(t)},t.convertAnyToType=e,t.convertStringToEnum=n,t.registerTypeConverter=r,t.registerEnumConverter=i}(nullstone||(nullstone={}));var nullstone;!function(t){var e=function(){function e(){}return e.prototype.loadAsync=function(e,n){var r=e+"/"+n;return new Promise(function(e,n){require([r],function(t){e(t)},function(e){return n(new t.DirLoadError(r,e))})})},e.prototype.resolveType=function(t,e,n){return n.isPrimitive=!1,n.type=require(t+"/"+e),void 0!==n.type},e}();t.DirResolver=e}(nullstone||(nullstone={}));var nullstone;!function(t){var e=function(){function t(t){this.Object=t}return t.fromAny=function(t,e,n){if("number"==typeof e)return e;if(!e)return n||0;var r=t[e.toString()];return null==r?n||0:r},t}();t.Enum=e}(nullstone||(nullstone={}));var nullstone;!function(t){function e(t,e){return null==t&&null==e?!0:null==t||null==e?!1:t===e?!0:!!t.equals&&t.equals(e)}t.equals=e}(nullstone||(nullstone={}));var nullstone;!function(t){var e=function(){function t(){this.$$callbacks=[],this.$$scopes=[]}return Object.defineProperty(t.prototype,"has",{get:function(){return this.$$callbacks.length>0},enumerable:!0,configurable:!0}),t.prototype.on=function(t,e){this.$$callbacks.push(t),this.$$scopes.push(e)},t.prototype.off=function(t,e){for(var n=this.$$callbacks,r=this.$$scopes,i=n.length-1;i>-1;)i=n.lastIndexOf(t,i),r[i]===e&&(n.splice(i,1),r.splice(i,1)),i--},t.prototype.raise=function(t,e){for(var n=0,r=this.$$callbacks.slice(0),i=this.$$scopes.slice(0),o=r.length;o>n;n++)r[n].call(i[n],t,e)},t.prototype.raiseAsync=function(t,e){var n=this;window.setTimeout(function(){return n.raise(t,e)},1)},t.prototype.subscribe=function(t){var e,n=this;return e=t instanceof Function?function(e,n){return t(n)}:function(e,n){return t.onNext(n)},this.on(e,t),{dispose:function(){return n.off(e,t)}}},t}();t.Event=e}(nullstone||(nullstone={}));var nullstone;!function(t){var e=function(){function e(t){Object.defineProperty(this,"name",{value:t,writable:!1})}return e.prototype.is=function(e){if(!e)return!1;for(var n=e.constructor;n;){var r=n.$$interfaces;if(r&&r.indexOf(this)>-1)return!0;n=t.getTypeParent(n)}return!1},e.prototype.as=function(t){return this.is(t)?t:void 0},e.prototype.mark=function(e){return t.addTypeInterfaces(e,this),this},e}();t.Interface=e}(nullstone||(nullstone={}));var nullstone;!function(t){t.ICollection_=new t.Interface("ICollection")}(nullstone||(nullstone={}));var nullstone;!function(t){t.IEnumerable_=new t.Interface("IEnumerable"),t.IEnumerable_.is=function(t){return t&&t.getEnumerator&&"function"==typeof t.getEnumerator},t.IEnumerable_.empty={getEnumerator:function(e){return t.IEnumerator_.empty}},t.IEnumerable_.fromArray=function(e){return{$$arr:e,getEnumerator:function(e){return t.IEnumerator_.fromArray(this.$$arr,e)}}},t.IEnumerable_.toArray=function(t){for(var e=[],n=t.getEnumerator();n.moveNext();)e.push(n.current);return e}}(nullstone||(nullstone={}));var nullstone;!function(t){t.IEnumerator_=new t.Interface("IEnumerator"),t.IEnumerator_.empty={current:void 0,moveNext:function(){return!1}},t.IEnumerator_.fromArray=function(t,e){var n,r=t.length,i={moveNext:void 0,current:void 0};return e?(n=r,i.moveNext=function(){return n--,0>n?(i.current=void 0,!1):(i.current=t[n],!0)}):(n=-1,i.moveNext=function(){return n++,n>=r?(i.current=void 0,!1):(i.current=t[n],!0)}),i}}(nullstone||(nullstone={}));var nullstone;!function(t){var e=function(){function e(){}return Object.defineProperty(e.prototype,"propertyType",{get:function(){return void 0},enumerable:!0,configurable:!0}),e.prototype.getValue=function(t,e){return this.GetFunc?this.GetFunc.call(t,e):void 0},e.prototype.setValue=function(t,e,n){this.SetFunc&&this.SetFunc.call(t,e,n)},e.find=function(n){var r=n,i=n instanceof Function;if(i&&(r=new n),r instanceof Array){var o=new e;return o.GetFunc=function(t){return this[t]},o.SetFunc=function(t,e){this[t]=e},o}var s=t.ICollection_.as(r);if(s){var o=new e;return o.GetFunc=function(t){return this.GetValueAt(t)},o.SetFunc=function(t,e){return this.SetValueAt(t,e)},o}},e}();t.IndexedPropertyInfo=e}(nullstone||(nullstone={}));var nullstone;!function(t){t.IDisposable_=new t.Interface("IDisposable"),t.IObservable_=new t.Interface("IObservable")}(nullstone||(nullstone={}));var nullstone;!function(t){t.IObserver_=new t.Interface("IObserver"),t.IObserver_.is=function(t){return t&&"function"==typeof t.onNext&&"function"==typeof t.onCompleted&&"function"==typeof t.onNext}}(nullstone||(nullstone={}));var nullstone;!function(t){function e(t,e){t.$$uri||Object.defineProperty(t,"$$uri",{value:e.toString(),enumerable:!1})}var n=function(){function n(e){this.$$module=null,this.$$sourcePath=null,this.$$basePath=null,this.$$primtypes={},this.$$types={},this.$$loaded=!1,Object.defineProperty(this,"name",{value:e,writable:!1});var n=e;0!==e.indexOf("http://")&&(n="lib://"+e),Object.defineProperty(this,"uri",{value:new t.Uri(n),writable:!1})}return Object.defineProperty(n.prototype,"sourcePath",{get:function(){var t=this.$$sourcePath||"lib/"+this.name+"/dist/"+this.name;return this.useMin?t+".min":t},set:function(t){".js"===t.substr(t.length-3)&&(t=t.substr(0,t.length-3)),this.useMin&&".min"===t.substr(t.length-4)&&(t=t.substr(0,t.length-4)),this.$$sourcePath=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"basePath",{get:function(){return this.$$basePath||"lib/"+this.name},set:function(t){this.$$basePath=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isLoaded",{get:function(){return!!this.$$loaded},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rootModule",{get:function(){return this.$$module=this.$$module||require(this.sourcePath)},enumerable:!0,configurable:!0}),n.prototype.loadAsync=function(){var e=this;return this.$$sourcePath||"http"!==this.uri.scheme||(this.$$loaded=!0),this.$$loaded?Promise.resolve(this):(this.$configModule(),new Promise(function(n,r){require([e.name],function(t){e.$$module=t,e.$$loaded=!0,n(e)},function(n){return r(new t.LibraryLoadError(e,n))})}))},n.prototype.$configModule=function(){var t={paths:{},shim:{},map:{"*":{}}},e=this.sourcePath;t.paths[this.name]=e,t.shim[this.name]={exports:this.exports,deps:this.deps},t.map["*"][e]=this.name,require.config(t)},n.prototype.resolveType=function(t,n,r){if(!t)return r.isPrimitive=!0,void 0!==(r.type=this.$$primtypes[n])?!0:(r.isPrimitive=!1,void 0!==(r.type=this.$$types[n]));var i=this.rootModule;if(r.isPrimitive=!1,r.type=void 0,"/"!==t)for(var o=0,s=t.substr(1).split(".");o<s.length&&i;o++)i=i[s[o]];if(!i)return!1;r.type=i[n];var u=r.type;return void 0===u?!1:(e(u,this.uri),!0)},n.prototype.add=function(n,r){if(!n)throw new Error("A type must be specified when registering '"+r+"'`.");if(r=r||t.getTypeName(n),!r)throw new Error("No type name found.");return e(n,this.uri),this.$$types[r]=n,this},n.prototype.addPrimitive=function(n,r){if(!n)throw new Error("A type must be specified when registering '"+r+"'`.");if(r=r||t.getTypeName(n),!r)throw new Error("No type name found.");return e(n,this.uri),this.$$primtypes[r]=n,this},n.prototype.addEnum=function(t,e){return this.addPrimitive(t,e),Object.defineProperty(t,"$$enum",{value:!0,writable:!1}),t.name=e,this},n}();t.Library=n}(nullstone||(nullstone={}));var nullstone;!function(t){var e=function(){function e(){this.$$libs={},this.libraryCreated=new t.Event,this.dirResolver=new t.DirResolver}return e.prototype.createLibrary=function(e){return new t.Library(e)},e.prototype.loadTypeAsync=function(t,e){var n=this.resolve(t);return n?n.loadAsync().then(function(t){var n={isPrimitive:!1,type:void 0};return t.resolveType(null,e,n)?n.type:null}):this.dirResolver.loadAsync(t,e)},e.prototype.resolve=function(e){var n=new t.Uri(e),r=n.scheme;if(!r)return null;var i="lib"===r?n.host:e,o=this.$$libs[i];return o||(o=this.$$libs[i]=this.createLibrary(i),this.$$onLibraryCreated(o)),o},e.prototype.resolveType=function(e,n,r){var i=new t.Uri(e),o=i.scheme;if(!o)return this.dirResolver.resolveType(e,n,r);var s="lib"===o?i.host:e,u="lib"===o?i.absolutePath:"",a=this.$$libs[s];return a||(a=this.$$libs[s]=this.createLibrary(s),this.$$onLibraryCreated(a)),a.resolveType(u,n,r)},e.prototype.$$onLibraryCreated=function(t){this.libraryCreated.raise(this,Object.freeze({library:t}))},e}();t.LibraryResolver=e}(nullstone||(nullstone={}));var nullstone;!function(t){var e=function(){function t(t){this.$$cache={},this.$$creator=t}return t.prototype.memoize=function(t){var e=this.$$cache[t];return e||(this.$$cache[t]=e=this.$$creator(t)),e},t}();t.Memoizer=e}(nullstone||(nullstone={}));var nullstone;!function(t){function e(t,e){if(!t)return void 0;var n=t.constructor,r=Object.getOwnPropertyDescriptor(n.prototype,e);return r?r:Object.getOwnPropertyDescriptor(t,e)}function n(t,e){if(!t)return!1;if(t.hasOwnProperty(e))return!0;var n=t.constructor;return n.prototype.hasOwnProperty(e)}t.getPropertyDescriptor=e,t.hasProperty=n}(nullstone||(nullstone={}));var nullstone;!function(t){var e=function(){function e(){}return e.prototype.getValue=function(t){return this.$$getFunc?this.$$getFunc.call(t):void 0},e.prototype.setValue=function(t,e){return this.$$setFunc?this.$$setFunc.call(t,e):void 0},e.find=function(n,r){var i=n,o=n instanceof Function;if(o&&(i=new n),!(i instanceof Object))return null;var s=r,u=t.getPropertyDescriptor(i,r);if(u){var a=new e;return a.name=r,a.$$getFunc=u.get,a.$$getFunc||(a.$$getFunc=function(){return this[s]}),a.$$setFunc=u.set,!a.$$setFunc&&u.writable&&(a.$$setFunc=function(t){this[s]=t}),a}var l=o?n:n.constructor,a=new e;return a.name=r,a.$$getFunc=l.prototype["Get"+r],a.$$setFunc=l.prototype["Set"+r],a},e}();t.PropertyInfo=e}(nullstone||(nullstone={}));var nullstone;!function(t){function e(t){var e=t;if(!e)return"";var n=e.name;if(n)return n;var n=e.toString().match(/function ([^\(]+)/)[1];return Object.defineProperty(e,"name",{enumerable:!1,value:n,writable:!1}),n}function n(t){if(t===Object)return null;var e=t.$$parent;if(!e){if(!t.prototype)return void 0;e=Object.getPrototypeOf(t.prototype).constructor,Object.defineProperty(t,"$$parent",{value:e,writable:!1})}return e}function r(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(e){for(var r=0,i=e.length;i>r;r++)if(!e[r]){console.warn("Registering undefined interface on type.",t);break}Object.defineProperty(t,"$$interfaces",{value:e,writable:!1})}}function i(t,e){for(var r=t;r&&r!==e;)r=n(r);return null!=r}t.getTypeName=e,t.getTypeParent=n,t.addTypeInterfaces=r,t.doesInheritFrom=i}(nullstone||(nullstone={}));var nullstone;!function(t){function e(t,e){var n="";"string"==typeof e?n=e:e instanceof i&&(n=e.originalString);var r=t.scheme+"://"+t.host;return"/"===n[0]?(n=n.substr(1),r+="/"):r+=t.absolutePath,"/"!==r[r.length-1]&&(r=r.substr(0,r.lastIndexOf("/")+1)),r+n}function n(t){switch(t){case"http":return 80;case"https":return 443;default:return 0}}!function(t){t[t.RelativeOrAbsolute=0]="RelativeOrAbsolute",t[t.Absolute=1]="Absolute",t[t.Relative=2]="Relative"}(t.UriKind||(t.UriKind={}));var r=t.UriKind,i=function(){function t(n,i){if("string"==typeof n)this.$$originalString=n,this.$$kind=i||r.RelativeOrAbsolute;else if(n instanceof t)if("string"==typeof i){if(n.kind===r.Relative)throw new Error("Base Uri cannot be relative when creating new relative Uri.");this.$$originalString=e(n,i),this.$$kind=r.RelativeOrAbsolute}else if(i instanceof t){if(n.kind===r.Relative)throw new Error("Base Uri cannot be relative when creating new relative Uri.");this.$$originalString=e(n,i.originalString),this.$$kind=r.RelativeOrAbsolute}else this.$$originalString=n.$$originalString,this.$$kind=n.$$kind}return Object.defineProperty(t.prototype,"kind",{get:function(){return this.$$kind},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"authority",{get:function(){var t=this.$$originalString,e=Math.max(3,t.indexOf("://")+3),n=t.indexOf("/",e);t=0>n?t.substr(e):t.substr(e,n-e);var r=t.indexOf("$"),i=t.indexOf("#"),o=t.indexOf("?"),s=Math.min(r>-1?r:Number.POSITIVE_INFINITY,i>-1?i:Number.POSITIVE_INFINITY,o>-1?o:Number.POSITIVE_INFINITY);return isFinite(s)&&(t=t.substr(0,s)),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"host",{get:function(){var t=this.authority,e=t.indexOf(":");return e>0?t.substr(0,e):t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"port",{get:function(){var t=this.authority,e=t.indexOf(":"),r=e>0&&e<t.length?t.substr(e+1):"";return r?parseInt(r)||0:n(this.scheme)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"absolutePath",{get:function(){var t=this.$$originalString,e=t.indexOf("#");e>-1&&(t=t.substr(0,e));var n=t.indexOf("$");n>-1&&(t=t.substr(0,n));var r=Math.max(3,t.indexOf("://")+3),i=t.indexOf("/",r);if(0>i||r>i)return"/";var o=t.indexOf("?",i);return 0>o||i>o?t.substr(i):t.substr(i,o-i)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scheme",{get:function(){var t=this.$$originalString,e=t.indexOf("://");return 0>e?null:t.substr(0,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fragment",{get:function(){var t=this.$$originalString,e=t.indexOf("$"),n=t.indexOf("#");return e>-1&&n>e&&(t=t.substr(0,e)),0>n?"":t.substr(n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resource",{get:function(){var t=this.$$originalString,e=t.indexOf("$");if(0>e)return"";var n=t.indexOf("#");if(n>-1&&e>n)return"";var r=t.indexOf("?");return r>-1&&e>r?"":t.substr(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"originalString",{get:function(){return this.$$originalString.toString()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAbsoluteUri",{get:function(){return!!this.scheme&&!!this.host},enumerable:!0,configurable:!0}),t.prototype.toString=function(){return this.$$originalString.toString()},t.prototype.equals=function(t){return this.$$originalString===t.$$originalString},t.isNullOrEmpty=function(t){return null==t?!0:!t.$$originalString},t}();t.Uri=i,t.registerTypeConverter(i,function(t){return null==t&&(t=""),new i(t.toString())})}(nullstone||(nullstone={}));var nullstone;!function(t){var e=function(){function e(e,n){this.defaultUri=e,this.xUri=n,this.libResolver=this.createLibResolver(),this.libResolver.resolve(e).add(Array,"Array"),this.libResolver.resolve(n).addPrimitive(String,"String").addPrimitive(Number,"Number").addPrimitive(Number,"Double").addPrimitive(Date,"Date").addPrimitive(RegExp,"RegExp").addPrimitive(Boolean,"Boolean").addPrimitive(t.Uri,"Uri")}return e.prototype.createLibResolver=function(){return new t.LibraryResolver},e.prototype.resolveLibrary=function(t){return this.libResolver.resolve(t||this.defaultUri)},e.prototype.loadTypeAsync=function(t,e){return this.libResolver.loadTypeAsync(t||this.defaultUri,e)},e.prototype.resolveType=function(t,e,n){return n.isPrimitive=!1,n.type=void 0,this.libResolver.resolveType(t||this.defaultUri,e,n)},e.prototype.add=function(t,e,n){var r=this.libResolver.resolve(t||this.defaultUri);return r&&r.add(n,e),this},e.prototype.addPrimitive=function(t,e,n){var r=this.libResolver.resolve(t||this.defaultUri);return r&&r.addPrimitive(n,e),this},e.prototype.addEnum=function(t,e,n){var r=this.libResolver.resolve(t||this.defaultUri);return r&&r.addEnum(n,e),this},e}();t.TypeManager=e}(nullstone||(nullstone={}));var nullstone;!function(t){var e=function(){function t(t){this.errors=t.filter(function(t){return!!t}),Object.freeze(this)}return Object.defineProperty(t.prototype,"flat",{get:function(){for(var e=[],n=0,r=this.errors;n<r.length;n++){var i=r[n];i instanceof t?e=e.concat(i.flat):e.push(i)}return e},enumerable:!0,configurable:!0}),t}();t.AggregateError=e}(nullstone||(nullstone={}));var nullstone;!function(t){var e=function(){function t(t,e){this.path=t,this.error=e,Object.freeze(this)}return t}();t.DirLoadError=e}(nullstone||(nullstone={}));var nullstone;!function(t){var e=function(){function t(t,e){this.library=t,this.error=e,Object.freeze(this)}return t}();t.LibraryLoadError=e}(nullstone||(nullstone={}));var nullstone;!function(t){var e;!function(t){function e(t,e,r,i){return t?("function"==typeof t.resolveTypeFields&&t.resolveTypeFields(function(t){return n(t,e,r)}),"function"==typeof t.transmute?t.transmute(i):t):t}function n(t,e,n){var r=null,i=t,o=i.indexOf(":");o>-1&&(r=i.substr(0,o),i=i.substr(o+1));var s=e.lookupNamespaceURI(r),u=n(s,i);return u.type}t.finishMarkupExtension=e}(e=t.markup||(t.markup={}))}(nullstone||(nullstone={}));var nullstone;!function(t){var e;!function(e){function n(t){return{resolveType:t.resolveType||function(t,e){return r},resolveObject:t.resolveObject||function(t){return new t},resolvePrimitive:t.resolvePrimitive||function(t,e){return new t(e)},resolveResources:t.resolveResources||function(t,e){return new Object},branchSkip:t.branchSkip||function(t,e){},object:t.object||function(t,e){},objectEnd:t.objectEnd||function(t,e,n){},contentText:t.contentText||function(t){},name:t.name||function(t){},propertyStart:t.propertyStart||function(t,e){},propertyEnd:t.propertyEnd||function(t,e){},attributeStart:t.attributeStart||function(t,e){},attributeEnd:t.attributeEnd||function(t,e,n){},error:t.error||function(t){return!0},end:t.end||function(){}}}e.NO_PARSER={on:function(t){return e.NO_PARSER},setNamespaces:function(t,n){return e.NO_PARSER},setExtensionParser:function(t){return e.NO_PARSER},parse:function(t){},skipBranch:function(){},resolvePrefix:function(t){return""},walkUpObjects:function(){return t.IEnumerator_.empty}};var r={isPrimitive:!1,type:Object};e.createMarkupSax=n}(e=t.markup||(t.markup={}))}(nullstone||(nullstone={}));var nullstone;!function(t){var e;!function(e){var n=function(){function n(e){this.$$isLoaded=!1,this.uri=new t.Uri(e)}return Object.defineProperty(n.prototype,"isLoaded",{get:function(){return this.$$isLoaded},enumerable:!0,configurable:!0}),n.prototype.createParser=function(){return e.NO_PARSER},n.prototype.resolve=function(t,n,r){var i=new e.MarkupDependencyResolver(t,this.createParser());return i.collect(this.root,n,r),i.resolve()},n.prototype.loadAsync=function(){var t=this,e="text!"+this.uri.toString(),n=this;return new Promise(function(r,i){require([e],function(e){n.setRoot(n.loadRoot(e)),t.$$isLoaded=!0,r(n)},i)})},n.prototype.loadRoot=function(t){return t},n.prototype.setRoot=function(t){return this.root=t,this},n}();e.Markup=n}(e=t.markup||(t.markup={}))}(nullstone||(nullstone={}));var nullstone;!function(t){var e;!function(t){var e=function(){function t(t,e){this.typeManager=t,this.parser=e,this.$$uris=[],this.$$names=[],this.$$fulls=[]}return t.prototype.collect=function(t,e,n){var r=this,i={},o={isPrimitive:!1,type:Object},s={uri:"",name:"",obj:void 0},u={resolveType:function(t,e){return t=t||r.typeManager.defaultUri,n&&n(t,e)||r.add(t,e),s.uri=t,s.name=e,o},resolveObject:function(t){return i},objectEnd:function(t,e,n){s.obj=t},propertyEnd:function(t,e){},attributeEnd:function(t,e,n){}};e&&(u.propertyEnd=function(t,n){e(s.uri,s.name,n,s.obj)},u.attributeEnd=function(t,n,r){e(s.uri,s.name,n,r)}),this.parser.on(u).parse(t)},t.prototype.add=function(t,e){var n=this.$$uris,r=this.$$names;if(null==this.typeManager.resolveLibrary(t)){var i=t+"/"+e;if(this.$$fulls.indexOf(i)>-1)return!1;this.$$fulls.push(i)}else if(n.indexOf(t)>-1)return!1;return n.push(t),r.push(e),!0},t.prototype.resolve=function(){for(var t=[],e=0,n=this.$$uris,r=this.$$names,i=this.typeManager;e<n.length;e++)t.push(i.loadTypeAsync(n[e],r[e]));return Promise.all(t)},t}();t.MarkupDependencyResolver=e}(e=t.markup||(t.markup={}))}(nullstone||(nullstone={}));var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},nullstone;!function(t){var e;!function(t){var e;!function(t){var e=function(t){function e(e){t.call(this,"Cannot skip branch when element contains more than 1 child element."),Object.defineProperties(this,{root:{value:e,writable:!1}})}return __extends(e,t),e}(Error);t.SkipBranchError=e}(e=t.xaml||(t.xaml={}))}(e=t.markup||(t.markup={}))}(nullstone||(nullstone={}));var nullstone;!function(t){var e;!function(t){var e;!function(e){function n(t){if(!t)return!1;var e=t[0].toUpperCase().charCodeAt(0);return e>=65&&90>=e}var r=function(){function r(){this.$$defaultXmlns="http://schemas.wsick.com/fayde",this.$$xXmlns="http://schemas.wsick.com/fayde/x"}return r.prototype.setNamespaces=function(t,e){return this.$$defaultXmlns=t,this.$$xXmlns=e,this},r.prototype.parse=function(e,r,i){if(!n(e[1]))return e;this.$$ensure();var o={text:e,i:1,acc:"",error:"",resolver:r},s=this.$$doParse(o,i);return o.error&&this.$$onError(o.error),s=t.finishMarkupExtension(s,r,this.$$onResolveType,i)},r.prototype.$$doParse=function(t,e){if(!this.$$parseName(t))return void 0;for(this.$$startExtension(t,e);t.i<t.text.length&&this.$$parseKeyValue(t,e)&&"}"!==t.text[t.i];);return e.pop()},r.prototype.$$parseName=function(t){var e=t.text.indexOf(" ",t.i);return e>t.i?(t.acc=t.text.substr(t.i,e-t.i),t.i=e+1,!0):(e=t.text.indexOf("}",t.i),e>t.i?(t.acc=t.text.substr(t.i,e-t.i),t.i=e,!0):(t.error="Missing closing bracket.",!1))},r.prototype.$$startExtension=function(t,n){var r,i=t.acc,o=i.indexOf(":"),s=0>o?null:i.substr(0,o),u=0>o?i:i.substr(o+1),a=s?t.resolver.lookupNamespaceURI(s):e.DEFAULT_XMLNS;if(a===this.$$xXmlns)if("Null"===u)r=this.$$parseXNull(t);else if("Type"===u)r=this.$$parseXType(t);else{if("Static"!==u)throw new Error("Unknown markup extension. ["+s+":"+u+"]");r=this.$$parseXStatic(t)}else{var l=this.$$onResolveType(a,u);r=this.$$onResolveObject(l.type)}n.push(r)},r.prototype.$$parseXNull=function(t){var e=t.text.indexOf("}",t.i);if(e<t.i)throw new Error("Unterminated string constant.");return t.i=e,null},r.prototype.$$parseXType=function(t){var e=t.text.indexOf("}",t.i);if(e<t.i)throw new Error("Unterminated string constant.");var n=t.text.substr(t.i,e-t.i);t.i=e;var r=n.indexOf(":"),i=0>r?null:n.substr(0,r),o=0>r?n:n.substr(r+1),s=t.resolver.lookupNamespaceURI(i),u=this.$$onResolveType(s,o);return u.type},r.prototype.$$parseXStatic=function(t){for(var e=t.text,n=e.length,r=t.i;t.i<n&&("}"!==e[t.i]||"\\"===e[t.i-1]);t.i++);var i=e.substr(r,t.i-r),o=new Function("return ("+i+");");return o()},r.prototype.$$parseKeyValue=function(t,e){var r=t.text;t.acc="";for(var i="",o=void 0,s=r.length,u=!1;t.i<s;t.i++){var a=r[t.i];if("\\"===a)t.i++,t.acc+=r[t.i];else if("{"===a){if(u||!n(r[t.i+1])){t.acc+=a,u=!0;continue}if(!i)return t.error="A sub extension must be set to a key.",!1;if(t.i++,o=this.$$doParse(t,e),t.error)return!1}else if("="===a)i=t.acc.trim(),t.acc="";else{if("}"===a)return u&&(u=!1,t.acc+=a),this.$$finishKeyValue(t,i,o,e),!0;if(","===a)return t.i++,this.$$finishKeyValue(t,i,o,e),!0;i&&!t.acc&&"'"===a?(t.i++,this.$$parseSingleQuoted(t),o=t.acc,t.acc=""):t.acc+=a}}throw new Error("Unterminated string constant.")},r.prototype.$$finishKeyValue=function(e,n,r,i){if(void 0!==r||(r=e.acc.trim())){r=t.finishMarkupExtension(r,e.resolver,this.$$onResolveType,i);var o=i[i.length-1];n?o[n]=r:o.init&&o.init(r)}},r.prototype.$$parseSingleQuoted=function(t){for(var e=t.text,n=e.length;t.i<n;t.i++){var r=e[t.i];if("\\"===r)t.i++,t.acc+=e[t.i];else{if("'"===r)return;t.acc+=r}}},r.prototype.$$ensure=function(){this.onResolveType(this.$$onResolveType).onResolveObject(this.$$onResolveObject).onError(this.$$onError)},r.prototype.onResolveType=function(t){var e={isPrimitive:!1,type:Object};return this.$$onResolveType=t||function(t,n){return e},this},r.prototype.onResolveObject=function(t){return this.$$onResolveObject=t||function(t){return new t},this},r.prototype.onResolvePrimitive=function(t){return this.$$onResolvePrimitive=t||function(t,e){return new t(e)},this},r.prototype.onError=function(t){return this.$$onError=t||function(t){},this},r}();e.XamlExtensionParser=r}(e=t.xaml||(t.xaml={}))}(e=t.markup||(t.markup={}))}(nullstone||(nullstone={}));var nullstone;!function(t){var e;!function(e){var n;!function(n){var r=new DOMParser,i=new t.Memoizer(function(t){return new o(t)}),o=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.create=function(t){return i.memoize(t.toString())},e.prototype.createParser=function(){return new n.XamlParser},e.prototype.loadRoot=function(t){var e=r.parseFromString(t,"text/xml");return e.documentElement},e}(e.Markup);n.XamlMarkup=o}(n=e.xaml||(e.xaml={}))}(e=t.markup||(t.markup={}))}(nullstone||(nullstone={}));var nullstone;!function(t){var e;!function(t){var e;!function(e){function n(t,e,n){for(var r=n+".Resources",i=t.firstElementChild;i;){if(i.localName===r&&i.namespaceURI===e)return i;i=i.nextElementSibling}return null}e.DEFAULT_XMLNS="http://schemas.wsick.com/fayde",e.DEFAULT_XMLNS_X="http://schemas.wsick.com/fayde/x";var r="http://www.w3.org/1999/xhtml",i="parsererror",o=function(){function o(){this.$$onEnd=null,this.$$objectStack=[],this.$$skipnext=!1,this.$$curel=null,this.$$curkey=void 0,this.setExtensionParser(new e.XamlExtensionParser).setNamespaces(e.DEFAULT_XMLNS,e.DEFAULT_XMLNS_X).on({})}return o.prototype.on=function(e){return e=t.createMarkupSax(e),this.$$onResolveType=e.resolveType,this.$$onResolveObject=e.resolveObject,this.$$onResolvePrimitive=e.resolvePrimitive,this.$$onResolveResources=e.resolveResources,this.$$onBranchSkip=e.branchSkip,this.$$onObject=e.object,this.$$onObjectEnd=e.objectEnd,this.$$onContentText=e.contentText,this.$$onName=e.name,this.$$onPropertyStart=e.propertyStart,this.$$onPropertyEnd=e.propertyEnd,this.$$onAttributeStart=e.attributeStart,this.$$onAttributeEnd=e.attributeEnd,this.$$onError=e.error,this.$$onEnd=e.end,this.$$extension&&this.$$extension.onResolveType(this.$$onResolveType).onResolveObject(this.$$onResolveObject).onResolvePrimitive(this.$$onResolvePrimitive),this},o.prototype.setNamespaces=function(t,e){return this.$$defaultXmlns=t,this.$$xXmlns=e,this.$$extension&&this.$$extension.setNamespaces(this.$$defaultXmlns,this.$$xXmlns),this},o.prototype.setExtensionParser=function(t){return this.$$extension=t,t&&t.setNamespaces(this.$$defaultXmlns,this.$$xXmlns).onResolveType(this.$$onResolveType).onResolveObject(this.$$onResolveObject).onResolvePrimitive(this.$$onResolvePrimitive).onError(function(t){throw t}),this},o.prototype.parse=function(t){if(!this.$$extension)throw new Error("No extension parser exists on parser.");return this.$$handleElement(t,!0),this.$$destroy(),this},o.prototype.skipBranch=function(){this.$$skipnext=!0},o.prototype.walkUpObjects=function(){var t=this.$$objectStack,e=t.length;return{current:void 0,moveNext:function(){return e--,void 0!==(this.current=t[e])}}},o.prototype.resolvePrefix=function(t){return this.$$curel.lookupNamespaceURI(t)},o.prototype.$$handleElement=function(t,r){var i=this.$$curel;this.$$curel=t;var o=t.localName,s=t.namespaceURI;if(this.$$tryHandleError(t,s,o)||this.$$tryHandlePropertyTag(t,s,o))return void(this.$$curel=i);var u=this.$$objectStack,a=this.$$onResolveType(s,o);if(this.$$tryHandlePrimitive(t,a,r))return void(this.$$curel=i);var l=this.$$onResolveObject(a.type);if(void 0!==l&&(u.push(l),this.$$onObject(l,r)),!this.$$skipnext){var c=n(t,s,o);c&&this.$$handleResources(l,a.type,c)}this.$$curkey=void 0,this.$$processAttributes(t);var f=this.$$curkey;if(this.$$skipnext){if(t.childElementCount>1&&!this.$$onError(new e.SkipBranchError(t)))return;return this.$$skipnext=!1,u.pop(),this.$$onObjectEnd(l,f,r,u[u.length-1]),this.$$onBranchSkip(t.firstElementChild,l),void(this.$$curel=i)}for(var p=t.firstElementChild,$=!!p;p;)c&&p===c||this.$$handleElement(p,!0),p=p.nextElementSibling;if(!$){var h=t.textContent;h&&(h=h.trim())&&this.$$onContentText(h)}void 0!==l&&(u.pop(),this.$$onObjectEnd(l,f,r,u[u.length-1])),this.$$curel=i},o.prototype.$$handleResources=function(t,e,n){var r=this.$$objectStack,i=this.$$onResolveResources(t,e);r.push(i),this.$$onObject(i,!1);for(var o=n.firstElementChild;o;)this.$$handleElement(o,!0),o=o.nextElementSibling;r.pop(),this.$$onObjectEnd(i,void 0,!1,r[r.length-1])},o.prototype.$$tryHandleError=function(t,e,n){return e!==r||n!==i?!1:(this.$$onError(new Error(t.textContent)),!0)},o.prototype.$$tryHandlePropertyTag=function(t,e,n){var r=n.indexOf(".");if(0>r)return!1;var i=this.$$onResolveType(e,n.substr(0,r)),o=i.type;n=n.substr(r+1),this.$$onPropertyStart(o,n);for(var s=t.firstElementChild;s;)this.$$handleElement(s,!1),s=s.nextElementSibling;return this.$$onPropertyEnd(o,n),!0},o.prototype.$$tryHandlePrimitive=function(t,e,n){if(!e.isPrimitive)return!1;var r=t.textContent,i=this.$$onResolvePrimitive(e.type,r?r.trim():"");this.$$onObject(i,n),this.$$curkey=void 0,this.$$processAttributes(t);var o=this.$$curkey,s=this.$$objectStack;return this.$$onObjectEnd(i,o,n,s[s.length-1]),!0},o.prototype.$$processAttributes=function(t){for(var e=0,n=t.attributes,r=n.length;r>e;e++)this.$$processAttribute(n[e])},o.prototype.$$processAttribute=function(t){var e=t.prefix,n=t.localName;if(this.$$shouldSkipAttr(e,n))return!0;var r=t.namespaceURI,i=t.value;return this.$$tryHandleXAttribute(r,n,i)?!0:this.$$handleAttribute(r,n,i,t)},o.prototype.$$shouldSkipAttr=function(t,e){return"xmlns"===t?!0:!t&&"xmlns"===e},o.prototype.$$tryHandleXAttribute=function(t,e,n){return t!==this.$$xXmlns?!1:("Name"===e&&this.$$onName(n),"Key"===e&&(this.$$curkey=n),!0)},o.prototype.$$handleAttribute=function(t,e,n,r){var i=null,e=e,o=e.indexOf(".");if(o>-1){var s=this.$$onResolveType(t,e.substr(0,o));i=s.type,e=e.substr(o+1)}this.$$onAttributeStart(i,e);var u=this.$$getAttrValue(n,r);return this.$$onAttributeEnd(i,e,u),!0},o.prototype.$$getAttrValue=function(t,e){return"{"!==t[0]?t:this.$$extension.parse(t,e,this.$$objectStack)},o.prototype.$$destroy=function(){this.$$onEnd&&this.$$onEnd()},o}();e.XamlParser=o}(e=t.xaml||(t.xaml={}))}(e=t.markup||(t.markup={}))}(nullstone||(nullstone={})),Array.isArray||(Array.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)});var nullstone;!function(t){function e(t,e,n){var r=!1;try{t(function(t){r||(r=!0,e(t))},function(t){r||(r=!0,n(t))})}catch(i){if(r)return;r=!0,n(i)}}var n="function"==typeof setImmediate&&setImmediate||function(t){setTimeout(t,1)},r=function(){function t(t){var n=this;if(this.$$state=null,this.$$value=null,this.$$deferreds=[],this._resolve=function(t){try{if(t===n)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){
var r=t.then;if("function"==typeof r)return void e(function(){return r.apply(t)},n._resolve,n._reject)}n.$$state=!0,n.$$value=t,n._finale()}catch(i){n._reject(i)}},this._reject=function(t){n.$$state=!1,n.$$value=t,n._finale()},"object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");e(t,this._resolve,this._reject)}return t.prototype.then=function(t,e){var n=this;return new Promise(function(r,o){return n._handle(new i(t,e,r,o))})},t.prototype["catch"]=function(t){return this.then(null,t)},t.prototype.tap=function(t,e){var n=this;return new Promise(function(r,i){n.then(function(e){var n=t?t(e):null;n&&"function"==typeof n.then?n.then(function(t){return r(e)},function(t){return i(t)}):r(e)},function(t){var n=e?e(t):null;n&&"function"==typeof n.then?n.then(function(e){return i(t)},function(t){return i(t)}):i(t)})})},t.prototype._handle=function(t){var e=this;return null===this.$$state?void this.$$deferreds.push(t):void n(function(){var n=e.$$state?t.onFulfilled:t.onRejected;if(null===n)return void(e.$$state?t.resolve:t.reject)(e.$$value);var r;try{r=n(e.$$value)}catch(i){return void t.reject(i)}r&&"function"==typeof r.then?r.then.call(r,t.resolve):t.resolve(r)})},t.all=function(){var t=Array.prototype.slice.call(1===arguments.length&&Array.isArray(arguments[0])?arguments[0]:arguments);return new Promise(function(e,n){function r(o,s){try{if(s&&("object"==typeof s||"function"==typeof s)){var u=s.then;if("function"==typeof u)return void u.call(s,function(t){r(o,t)},n)}t[o]=s,0===--i&&e(t)}catch(a){n(a)}}if(0===t.length)return e([]);for(var i=t.length,o=0;o<t.length;o++)r(o,t[o])})},t.race=function(t){return new Promise(function(e,n){for(var r=0,i=t.length;i>r;r++)t[r].then(e,n)})},t.reject=function(t){return new Promise(function(e,n){return n(t)})},t.resolve=function(t){return t instanceof Promise?t:new Promise(function(e,n){return e(t)})},t.prototype._finale=function(){for(var t=0,e=this.$$deferreds.length;e>t;t++)this._handle(this.$$deferreds[t]);this.$$deferreds=null},t.prototype._setImmediateFn=function(t){n=t},t}();t.PromiseImpl=r;var i=function(){function t(t,e,n,r){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.resolve=n,this.reject=r}return t}()}(nullstone||(nullstone={})),function(t){"function"!=typeof t.Promise&&(t.Promise=nullstone.PromiseImpl)}(this),function(t){t.Promise&&"function"!=typeof t.Promise.prototype.tap&&(t.Promise.prototype.tap=nullstone.PromiseImpl.prototype.tap)}(this);
//# sourceMappingURL=nullstone.min.js.map
var requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){window.setTimeout(callback,5)}}(),etch;!function(etch){var engine;!function(engine){var ClockTimer=function(){function ClockTimer(){this._listeners=[],this._lastTime=0}return ClockTimer.prototype.registerTimer=function(listener){var ls=this._listeners,index=ls.indexOf(listener);index>-1||(ls.push(listener),1===ls.length&&this._requestAnimationTick())},ClockTimer.prototype.unregisterTimer=function(listener){var ls=this._listeners,index=ls.indexOf(listener);index>-1&&ls.splice(index,1)},ClockTimer.prototype._doTick=function(){var nowTime=(new Date).getTime(),lastTime=this._lastTime;this._lastTime=nowTime;var ls=this._listeners,len=ls.length;if(0!==len){for(var i=0;i<len;i++)ls[i].onTicked(lastTime,nowTime);this._requestAnimationTick()}},ClockTimer.prototype._requestAnimationTick=function(){var _this=this;requestAnimFrame(function(){return _this._doTick()})},ClockTimer}();engine.ClockTimer=ClockTimer}(engine=etch.engine||(etch.engine={}))}(etch||(etch={}));var etch;!function(etch){var primitives;!function(primitives){var Vector=function(){function Vector(x,y){this.x=x,this.y=y}return Vector.prototype.get=function(){return new Vector(this.x,this.y)},Vector.prototype.set=function(x,y){this.x=x,this.y=y},Vector.prototype.add=function(v){return this.x+=v.x,this.y+=v.y,this},Vector.add=function(v1,v2){return new Vector(v1.x+v2.x,v1.y+v2.y)},Vector.prototype.clone=function(){return new Vector(this.x,this.y)},Vector.LERP=function(start,end,p){var x=start.x+(end.x-start.x)*p,y=start.y+(end.y-start.y)*p;return new Vector(x,y)},Vector.prototype.sub=function(v){return this.x-=v.x,this.y-=v.y,this},Vector.sub=function(v1,v2){return new Vector(v1.x-v2.x,v1.y-v2.y)},Vector.prototype.mult=function(n){return this.x=this.x*n,this.y=this.y*n,this},Vector.mult=function(v1,v2){return new Vector(v1.x*v2.x,v1.y*v2.y)},Vector.multN=function(v1,n){return new Vector(v1.x*n,v1.y*n)},Vector.prototype.div=function(n){return this.x=this.x/n,this.y=this.y/n,this},Vector.div=function(v1,v2){return new Vector(v1.x/v2.x,v1.y/v2.y)},Vector.divN=function(v1,n){return new Vector(v1.x/n,v1.y/n)},Vector.prototype.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Vector.prototype.magSq=function(){return this.x*this.x+this.y*this.y},Vector.prototype.normalize=function(){var m=this.mag();return 0!=m&&1!=m&&this.div(m),this},Vector.prototype.limit=function(max){return this.magSq()>max*max&&(this.normalize(),this.mult(max)),this},Vector.prototype.heading=function(){var angle=Math.atan2(-this.y,this.x);return-1*angle},Vector.random2D=function(){return Vector.fromAngle(Math.random()*Math.TAU)},Vector.fromAngle=function(angle){return new Vector(Math.cos(angle),Math.sin(angle))},Vector.prototype.toPoint=function(){return new primitives.Point(this.x,this.y)},Vector}();primitives.Vector=Vector}(primitives=etch.primitives||(etch.primitives={}))}(etch||(etch={}));var __extends=this&&this.__extends||function(d,b){function __(){this.constructor=d}for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p]);d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)},etch;!function(etch){var exceptions;!function(exceptions){var Exception=function(){function Exception(message){this.Message=message}return Exception.prototype.toString=function(){var typeName=this.constructor.name;return typeName?typeName+": "+this.Message:this.Message},Exception}();exceptions.Exception=Exception;var ArgumentException=function(_super){function ArgumentException(message){_super.call(this,message)}return __extends(ArgumentException,_super),ArgumentException}(Exception);exceptions.ArgumentException=ArgumentException;var ArgumentNullException=function(_super){function ArgumentNullException(message){_super.call(this,message)}return __extends(ArgumentNullException,_super),ArgumentNullException}(Exception);exceptions.ArgumentNullException=ArgumentNullException;var InvalidOperationException=function(_super){function InvalidOperationException(message){_super.call(this,message)}return __extends(InvalidOperationException,_super),InvalidOperationException}(Exception);exceptions.InvalidOperationException=InvalidOperationException;var NotSupportedException=function(_super){function NotSupportedException(message){_super.call(this,message)}return __extends(NotSupportedException,_super),NotSupportedException}(Exception);exceptions.NotSupportedException=NotSupportedException;var IndexOutOfRangeException=function(_super){function IndexOutOfRangeException(index){_super.call(this,index.toString())}return __extends(IndexOutOfRangeException,_super),IndexOutOfRangeException}(Exception);exceptions.IndexOutOfRangeException=IndexOutOfRangeException;var ArgumentOutOfRangeException=function(_super){function ArgumentOutOfRangeException(msg){_super.call(this,msg)}return __extends(ArgumentOutOfRangeException,_super),ArgumentOutOfRangeException}(Exception);exceptions.ArgumentOutOfRangeException=ArgumentOutOfRangeException;var AttachException=function(_super){function AttachException(message,data){_super.call(this,message),this.Data=data}return __extends(AttachException,_super),AttachException}(Exception);exceptions.AttachException=AttachException;var InvalidJsonException=function(_super){function InvalidJsonException(jsonText,innerException){_super.call(this,"Invalid json."),this.JsonText=jsonText,this.InnerException=innerException}return __extends(InvalidJsonException,_super),InvalidJsonException}(Exception);exceptions.InvalidJsonException=InvalidJsonException;var TargetInvocationException=function(_super){function TargetInvocationException(message,innerException){_super.call(this,message),this.InnerException=innerException}return __extends(TargetInvocationException,_super),TargetInvocationException}(Exception);exceptions.TargetInvocationException=TargetInvocationException;var UnknownTypeException=function(_super){function UnknownTypeException(fullTypeName){_super.call(this,fullTypeName),this.FullTypeName=fullTypeName}return __extends(UnknownTypeException,_super),UnknownTypeException}(Exception);exceptions.UnknownTypeException=UnknownTypeException;var FormatException=function(_super){function FormatException(message){_super.call(this,message)}return __extends(FormatException,_super),FormatException}(Exception);exceptions.FormatException=FormatException}(exceptions=etch.exceptions||(etch.exceptions={}))}(etch||(etch={}));var etch;!function(etch){var collections;!function(collections){var ObservableCollection=function(){function ObservableCollection(){this._ht=[],this.CollectionChanged=new nullstone.Event,this.PropertyChanged=new nullstone.Event}return ObservableCollection.prototype.getEnumerator=function(){return nullstone.IEnumerator_.fromArray(this._ht)},Object.defineProperty(ObservableCollection.prototype,"Count",{get:function(){return this._ht.length},enumerable:!0,configurable:!0}),ObservableCollection.prototype.ToArray=function(){return this._ht.slice(0)},ObservableCollection.prototype.GetValueAt=function(index){var ht=this._ht;if(index<0||index>=ht.length)throw new etch.exceptions.IndexOutOfRangeException(index);return ht[index]},ObservableCollection.prototype.SetValueAt=function(index,value){var ht=this._ht;if(index<0||index>=ht.length)throw new etch.exceptions.IndexOutOfRangeException(index);var oldValue=ht[index];ht[index]=value,this.CollectionChanged.raise(this,CollectionChangedEventArgs.Replace(value,oldValue,index))},ObservableCollection.prototype.Add=function(value){var index=this._ht.push(value)-1;this.CollectionChanged.raise(this,CollectionChangedEventArgs.Add(value,index)),this._RaisePropertyChanged("Count")},ObservableCollection.prototype.AddRange=function(values){for(var index=this._ht.length,len=values.length,i=0;i<len;i++)this._ht.push(values[i]);this.CollectionChanged.raise(this,CollectionChangedEventArgs.AddRange(values,index)),this._RaisePropertyChanged("Count")},ObservableCollection.prototype.Insert=function(index,value){var ht=this._ht;if(index<0||index>ht.length)throw new etch.exceptions.IndexOutOfRangeException(index);index>=ht.length?ht.push(value):ht.splice(index,0,value),this.CollectionChanged.raise(this,CollectionChangedEventArgs.Add(value,index)),this._RaisePropertyChanged("Count")},ObservableCollection.prototype.IndexOf=function(value){return this._ht.indexOf(value)},ObservableCollection.prototype.Contains=function(value){return this._ht.indexOf(value)>-1},ObservableCollection.prototype.Remove=function(value){var index=this._ht.indexOf(value);return!(index<0)&&(this._ht.splice(index,1),this.CollectionChanged.raise(this,CollectionChangedEventArgs.Remove(value,index)),this._RaisePropertyChanged("Count"),!0)},ObservableCollection.prototype.RemoveAt=function(index){if(index<0||index>=this._ht.length)throw new etch.exceptions.IndexOutOfRangeException(index);var item=this._ht.splice(index,1)[0];this.CollectionChanged.raise(this,CollectionChangedEventArgs.Remove(item,index)),this._RaisePropertyChanged("Count")},ObservableCollection.prototype.Clear=function(){var old=this._ht;this._ht=[],this.CollectionChanged.raise(this,CollectionChangedEventArgs.Reset(old)),this._RaisePropertyChanged("Count")},ObservableCollection.prototype._RaisePropertyChanged=function(propertyName){this.PropertyChanged.raise(this,new collections.PropertyChangedEventArgs(propertyName))},ObservableCollection}();collections.ObservableCollection=ObservableCollection}(collections=etch.collections||(etch.collections={}))}(etch||(etch={}));var etch;!function(etch){var collections;!function(collections){var PropertyChangedEventArgs=function(){function PropertyChangedEventArgs(propertyName){Object.defineProperty(this,"PropertyName",{value:propertyName,writable:!1})}return PropertyChangedEventArgs}();collections.PropertyChangedEventArgs=PropertyChangedEventArgs,collections.INotifyPropertyChanged_=new nullstone.Interface("INotifyPropertyChanged"),collections.INotifyPropertyChanged_.is=function(o){return o&&o.PropertyChanged instanceof nullstone.Event}}(collections=etch.collections||(etch.collections={}))}(etch||(etch={}));var Size=etch.primitives.Size,etch;!function(etch){var drawing;!function(drawing){var Canvas=function(){function Canvas(parentElement){this.isCached=!1,this.htmlElement=document.createElement("canvas"),parentElement?parentElement.appendChild(this.htmlElement):document.body.appendChild(this.htmlElement)}return Object.defineProperty(Canvas.prototype,"ctx",{get:function(){return this.htmlElement.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"width",{get:function(){return this.ctx.canvas.width},set:function(value){this.ctx.canvas.width=value},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"height",{get:function(){return this.ctx.canvas.height},set:function(value){this.ctx.canvas.height=value},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"size",{get:function(){return new Size(this.width,this.height)},enumerable:!0,configurable:!0}),Object.defineProperty(Canvas.prototype,"style",{get:function(){return this.ctx.canvas.style},enumerable:!0,configurable:!0}),Canvas.prototype.hide=function(){this.style.display="none"},Canvas.prototype.show=function(){this.style.display="block"},Canvas}();drawing.Canvas=Canvas}(drawing=etch.drawing||(etch.drawing={}))}(etch||(etch={}));var etch;!function(etch){var drawing;!function(drawing){var DisplayObject=function(){function DisplayObject(){this._displayList=new drawing.DisplayObjectCollection,this.frameCount=-1,this.isCached=!1,this.isInitialised=!1,this.isPaused=!1,this.isVisible=!0,this.lastVisualTick=0}return DisplayObject.prototype.init=function(drawTo,drawFrom){this.drawTo=drawTo,drawFrom&&(this.drawFrom=drawFrom),this.isInitialised=!0},Object.defineProperty(DisplayObject.prototype,"ctx",{get:function(){return this.drawTo.ctx},enumerable:!0,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"canvasWidth",{get:function(){return this.ctx.canvas.width},enumerable:!0,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"canvasHeight",{get:function(){return this.ctx.canvas.height},enumerable:!0,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"stage",{get:function(){return this.drawTo.ctx.stage},enumerable:!0,configurable:!0}),Object.defineProperty(DisplayObject.prototype,"displayList",{get:function(){return this._displayList},set:function(value){this._displayList=value},enumerable:!0,configurable:!0}),DisplayObject.prototype.setup=function(){},DisplayObject.prototype.update=function(){},DisplayObject.prototype.draw=function(){},DisplayObject.prototype.isFirstFrame=function(){return 0===this.frameCount},DisplayObject.prototype.dispose=function(){},DisplayObject.prototype.play=function(){this.isPaused=!1;for(var i=0;i<this.displayList.Count;i++){var displayObject=this.displayList.GetValueAt(i);displayObject.play()}},DisplayObject.prototype.pause=function(){this.isPaused=!0;for(var i=0;i<this.displayList.Count;i++){var displayObject=this.displayList.GetValueAt(i);displayObject.pause()}},DisplayObject.prototype.resize=function(){},DisplayObject.prototype.show=function(){this.isVisible=!0;for(var i=0;i<this.displayList.Count;i++){var displayObject=this.displayList.GetValueAt(i);displayObject.show()}},DisplayObject.prototype.hide=function(){this.isVisible=!1;for(var i=0;i<this.displayList.Count;i++){var displayObject=this.displayList.GetValueAt(i);displayObject.hide()}},DisplayObject}();drawing.DisplayObject=DisplayObject}(drawing=etch.drawing||(etch.drawing={}))}(etch||(etch={}));var __extends=this&&this.__extends||function(d,b){function __(){this.constructor=d}for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p]);d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)},ObservableCollection=etch.collections.ObservableCollection,etch;!function(etch){var drawing;!function(drawing){var DisplayObjectCollection=function(_super){function DisplayObjectCollection(){var _this=this;_super.call(this),this.CollectionChanged.on(function(){for(var i=0;i<_this.Count;i++){var obj=_this.GetValueAt(i);obj.zIndex=i}},this)}return __extends(DisplayObjectCollection,_super),DisplayObjectCollection.prototype.add=function(value){_super.prototype.Add.call(this,value)},DisplayObjectCollection.prototype.addRange=function(values){_super.prototype.AddRange.call(this,values)},DisplayObjectCollection.prototype.remove=function(value){return _super.prototype.Remove.call(this,value)},DisplayObjectCollection.prototype.swap=function(obj1,obj2){var obj1Index=this.IndexOf(obj1),obj2Index=this.IndexOf(obj2);this.setIndex(obj1,obj2Index),this.setIndex(obj2,obj1Index)},DisplayObjectCollection.prototype.toFront=function(obj){var index=0;this.Count>0&&(index=this.Count-1),this.setIndex(obj,index)},DisplayObjectCollection.prototype.toBack=function(obj){this.setIndex(obj,0)},DisplayObjectCollection.prototype.setIndex=function(obj,index){if(index>this.Count||index<0)throw new etch.exceptions.Exception("index out of range");this.Remove(obj),this.Insert(index,obj)},Object.defineProperty(DisplayObjectCollection.prototype,"bottom",{get:function(){return this.GetValueAt(0)},enumerable:!0,configurable:!0}),Object.defineProperty(DisplayObjectCollection.prototype,"top",{get:function(){return this.GetValueAt(this.Count-1)},enumerable:!0,configurable:!0}),DisplayObjectCollection}(ObservableCollection);drawing.DisplayObjectCollection=DisplayObjectCollection}(drawing=etch.drawing||(etch.drawing={}))}(etch||(etch={}));var DisplayObjectCollection=etch.drawing.DisplayObjectCollection,Point=etch.primitives.Point,Stage=etch.drawing.Stage,__extends=this&&this.__extends||function(d,b){function __(){this.constructor=d}for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p]);d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)},ClockTimer=etch.engine.ClockTimer,Canvas=etch.drawing.Canvas,DisplayObject=etch.drawing.DisplayObject,etch;!function(etch){var drawing;!function(drawing){var Stage=function(_super){function Stage(maxDelta){_super.call(this),this.deltaTime=new Date(0).getTime(),this.lastVisualTick=new Date(0).getTime(),this.mousePos=new etch.primitives.Point(0,0),this.ticked=new nullstone.Event,this._maxDelta=maxDelta||1e3/60}return __extends(Stage,_super),Stage.prototype.init=function(drawTo){var _this=this;drawTo.ctx.stage=this,_super.prototype.init.call(this,drawTo),this.timer=new ClockTimer,this.timer.registerTimer(this),this.canvas.htmlElement.addEventListener("mousemove",function(e){_this.mousePos=_this._getMousePos(_this.canvas.htmlElement,e)},!1)},Object.defineProperty(Stage.prototype,"canvas",{get:function(){return this.drawTo},enumerable:!0,configurable:!0}),Object.defineProperty(Stage.prototype,"width",{get:function(){return this.canvas.width},enumerable:!0,configurable:!0}),Object.defineProperty(Stage.prototype,"height",{get:function(){return this.canvas.height},enumerable:!0,configurable:!0}),Stage.prototype._getMousePos=function(canvas,e){var rect=canvas.getBoundingClientRect(),pos=new etch.primitives.Point;return pos.x=e.clientX-rect.left,pos.y=e.clientY-rect.top,pos},Stage.prototype.onTicked=function(lastTime,nowTime){this.frameCount++,this.deltaTime=Math.min(nowTime-this.lastVisualTick,this._maxDelta),this.lastVisualTick=nowTime,this.ticked.raise(this,this.lastVisualTick),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.width,this.height),this.isFirstFrame()&&(this.setup(),this.setupDisplayList(this.displayList)),this.update(),this.updateDisplayList(this.displayList),this.draw(),this.drawDisplayList(this.displayList)},Stage.prototype.setup=function(){_super.prototype.setup.call(this)},Stage.prototype.setupDisplayList=function(displayList){for(var i=0;i<displayList.Count;i++){var displayObject=displayList.GetValueAt(i);displayObject.setup(),this.setupDisplayList(displayObject.displayList)}},Stage.prototype.update=function(){_super.prototype.update.call(this)},Stage.prototype.updateDisplayList=function(displayList){for(var i=0;i<displayList.Count;i++){var displayObject=displayList.GetValueAt(i);displayObject.frameCount++,displayObject.deltaTime=this.deltaTime,displayObject.lastVisualTick=this.lastVisualTick,displayObject.isPaused||displayObject.update(),this.updateDisplayList(displayObject.displayList)}},Stage.prototype.draw=function(){_super.prototype.draw.call(this)},Stage.prototype.drawDisplayList=function(displayList){for(var i=0;i<displayList.Count;i++){var displayObject=displayList.GetValueAt(i);displayObject.isVisible&&displayObject.draw(),this.drawDisplayList(displayObject.displayList)}},Stage.prototype.resizeDisplayList=function(displayList){for(var i=0;i<displayList.Count;i++){var displayObject=displayList.GetValueAt(i);displayObject.resize(),this.resizeDisplayList(displayObject.displayList)}},Stage.prototype.dispose=function(){this.disposeDisplayList(this.displayList),this.timer.unregisterTimer(this)},Stage.prototype.disposeDisplayList=function(displayList){for(var i=0;i<displayList.Count;i++){var displayObject=displayList.GetValueAt(i);displayObject.dispose(),this.disposeDisplayList(displayObject.displayList)}},Stage.prototype.resize=function(){_super.prototype.resize.call(this),this.resizeDisplayList(this.displayList)},Stage}(drawing.DisplayObject);drawing.Stage=Stage}(drawing=etch.drawing||(etch.drawing={}))}(etch||(etch={}));var etch;!function(etch){var events;!function(events){!function(CollectionChangedAction){CollectionChangedAction[CollectionChangedAction.Add=1]="Add",CollectionChangedAction[CollectionChangedAction.Remove=2]="Remove",CollectionChangedAction[CollectionChangedAction.Replace=3]="Replace",CollectionChangedAction[CollectionChangedAction.Reset=4]="Reset"}(events.CollectionChangedAction||(events.CollectionChangedAction={}));var CollectionChangedAction=events.CollectionChangedAction,CollectionChangedEventArgs=function(){function CollectionChangedEventArgs(){}return CollectionChangedEventArgs.Reset=function(allValues){var args=new CollectionChangedEventArgs;return Object.defineProperty(args,"Action",{value:CollectionChangedAction.Reset,writable:!1}),Object.defineProperty(args,"OldStartingIndex",{value:0,writable:!1}),Object.defineProperty(args,"NewStartingIndex",{value:-1,writable:!1}),Object.defineProperty(args,"OldItems",{value:allValues,writable:!1}),Object.defineProperty(args,"NewItems",{value:null,writable:!1}),args},CollectionChangedEventArgs.Replace=function(newValue,oldValue,index){var args=new CollectionChangedEventArgs;return Object.defineProperty(args,"Action",{value:CollectionChangedAction.Replace,writable:!1}),Object.defineProperty(args,"OldStartingIndex",{value:-1,writable:!1}),Object.defineProperty(args,"NewStartingIndex",{value:index,writable:!1}),Object.defineProperty(args,"OldItems",{value:[oldValue],writable:!1}),Object.defineProperty(args,"NewItems",{value:[newValue],writable:!1}),args},CollectionChangedEventArgs.Add=function(newValue,index){var args=new CollectionChangedEventArgs;return Object.defineProperty(args,"Action",{value:CollectionChangedAction.Add,writable:!1}),Object.defineProperty(args,"OldStartingIndex",{value:-1,writable:!1}),Object.defineProperty(args,"NewStartingIndex",{value:index,writable:!1}),Object.defineProperty(args,"OldItems",{value:null,writable:!1}),Object.defineProperty(args,"NewItems",{value:[newValue],writable:!1}),args},CollectionChangedEventArgs.AddRange=function(newValues,index){var args=new CollectionChangedEventArgs;return Object.defineProperty(args,"Action",{value:CollectionChangedAction.Add,writable:!1}),Object.defineProperty(args,"OldStartingIndex",{value:-1,writable:!1}),Object.defineProperty(args,"NewStartingIndex",{value:index,writable:!1}),Object.defineProperty(args,"OldItems",{value:null,writable:!1}),Object.defineProperty(args,"NewItems",{value:newValues,writable:!1}),args},CollectionChangedEventArgs.Remove=function(oldValue,index){var args=new CollectionChangedEventArgs;return Object.defineProperty(args,"Action",{value:CollectionChangedAction.Remove,writable:!1}),Object.defineProperty(args,"OldStartingIndex",{value:index,writable:!1}),Object.defineProperty(args,"NewStartingIndex",{value:-1,writable:!1}),Object.defineProperty(args,"OldItems",{value:[oldValue],writable:!1}),Object.defineProperty(args,"NewItems",{value:null,writable:!1}),args},CollectionChangedEventArgs}();events.CollectionChangedEventArgs=CollectionChangedEventArgs}(events=etch.events||(etch.events={}))}(etch||(etch={}));var CollectionChangedEventArgs=etch.events.CollectionChangedEventArgs,etch;!function(etch){var events;!function(events){events.INotifyCollectionChanged_=new nullstone.Interface("INotifyCollectionChanged"),events.INotifyCollectionChanged_.is=function(o){return o&&o.CollectionChanged instanceof nullstone.Event}}(events=etch.events||(etch.events={}))}(etch||(etch={}));var etch;!function(etch){var events;!function(events){var PropertyChangedEventArgs=function(){function PropertyChangedEventArgs(propertyName){Object.defineProperty(this,"PropertyName",{value:propertyName,writable:!1})}return PropertyChangedEventArgs}();events.PropertyChangedEventArgs=PropertyChangedEventArgs,events.INotifyPropertyChanged_=new nullstone.Interface("INotifyPropertyChanged"),events.INotifyPropertyChanged_.is=function(o){return o&&o.PropertyChanged instanceof nullstone.Event}}(events=etch.events||(etch.events={}))}(etch||(etch={}));var __extends=this&&this.__extends||function(d,b){function __(){this.constructor=d}for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p]);d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)},RoutedEventArgs=etch.events.RoutedEventArgs,etch;!function(etch){var events;!function(events){var RoutedEvent=function(_super){function RoutedEvent(){_super.apply(this,arguments)}return __extends(RoutedEvent,_super),RoutedEvent}(nullstone.Event);events.RoutedEvent=RoutedEvent}(events=etch.events||(etch.events={}))}(etch||(etch={}));var etch;!function(etch){var events;!function(events){var RoutedEventArgs=function(){function RoutedEventArgs(){this.Handled=!1,this.Source=null,this.OriginalSource=null}return RoutedEventArgs}();events.RoutedEventArgs=RoutedEventArgs}(events=etch.events||(etch.events={}))}(etch||(etch={}));var etch;!function(etch){var primitives;!function(primitives){var Point=function(){function Point(x,y){this.x=null==x?0:x,this.y=null==y?0:y}return Point.isEqual=function(p1,p2){return p1.x===p2.x&&p1.y===p2.y},Point.copyTo=function(src,dest){dest.x=src.x,dest.y=src.y},Point.prototype.clone=function(){return new Point(this.x,this.y)},Point.prototype.toVector=function(){return new primitives.Vector(this.x,this.y)},Point}();primitives.Point=Point}(primitives=etch.primitives||(etch.primitives={}))}(etch||(etch={}));var etch;!function(etch){var primitives;!function(primitives){var Size=function(){function Size(width,height){this.width=null==width?0:width,this.height=null==height?0:height}return Size.copyTo=function(src,dest){dest.width=src.width,dest.height=src.height},Size.isEqual=function(size1,size2){return size1.width===size2.width&&size1.height===size2.height},Size.isEmpty=function(size){return 0===size.width||0===size.height},Size.min=function(dest,size2){dest.width=Math.min(dest.width,size2.width),dest.height=Math.min(dest.height,size2.height)},Size.isUndef=function(size){return isNaN(size.width)&&isNaN(size.height)},Size.undef=function(size){size.width=NaN,size.height=NaN},Size}();primitives.Size=Size}(primitives=etch.primitives||(etch.primitives={}))}(etch||(etch={}));
!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.etchComponentTest=f()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){var MyComponents,__extends=this&&this.__extends||function(d,b){function __(){this.constructor=d}for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p]);d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)};!function(MyComponents){var EtchComponent=function(_super){function EtchComponent(options){_super.call(this,options),this._init(),this._resize()}return __extends(EtchComponent,_super),EtchComponent.prototype.test=function(){this._emit(EtchComponent.Events.TEST,[1,2,"three"])},EtchComponent.prototype._init=function(){var _this=this,success=_super.prototype._init.call(this);return success||console.error("Component failed to initialise"),this.canvas=new Canvas,this.canvas.style.backgroundColor="#333",this.canvas.width=750,this.canvas.height=750,this.main=new MyComponents.Main,this.main.init(this.canvas),this.main.shapeCompleted.on(function(s,svg){_this._emit(EtchComponent.Events.SHAPECOMPLETED,[svg])},this),success},EtchComponent.prototype._getDefaultOptions=function(){return{}},EtchComponent.prototype._resize=function(){},EtchComponent}(_Components.BaseComponent);MyComponents.EtchComponent=EtchComponent}(MyComponents||(MyComponents={}));var MyComponents;!function(MyComponents){var EtchComponent;!function(EtchComponent){var Events=function(){function Events(){}return Events.TEST="test",Events.SHAPECOMPLETED="shapeCompleted",Events}();EtchComponent.Events=Events}(EtchComponent=MyComponents.EtchComponent||(MyComponents.EtchComponent={}))}(MyComponents||(MyComponents={})),function(w){w.MyComponents?w.MyComponents.EtchComponent=MyComponents.EtchComponent:w.MyComponents=MyComponents}(window);var MyComponents,__extends=this&&this.__extends||function(d,b){function __(){this.constructor=d}for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p]);d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)};!function(MyComponents){var Main=function(_super){function Main(maxDelta){_super.call(this,maxDelta),this.drawmode=!1,this.shapeCompleted=new nullstone.Event}return __extends(Main,_super),Main.prototype.setup=function(){var _this=this;_super.prototype.setup.call(this),this.shapes=[],this.currentPos={x:0,y:0},this.position=null,this.stage.mousePos.x=0,this.stage.mousePos.y=0,this.canvas.htmlElement.addEventListener("mousedown",function(e){_this.mousePos=_this.stage.mousePos.clone(),console.log("mouseX: ",_this.mousePos.x," mouseY: ",_this.mousePos.y),_this.toggleDrawMode(),_this.drawmode?(_this.currentPos.x=_this.mousePos.x,_this.currentPos.y=_this.mousePos.y):(_this.rectangle={x:_this.currentPos.x,y:_this.currentPos.y,w:_this.mousePos.x-_this.currentPos.x,h:_this.mousePos.y-_this.currentPos.y},_this.drawRect(_this.rectangle))},!1)},Main.prototype.drawRect=function(r){this.shapes.push(r),this.shapeCompleted.raise(this,"rectangle complete")},Main.prototype.toggleDrawMode=function(){this.drawmode=!this.drawmode},Main.prototype.update=function(){this.rectangle={x:this.currentPos.x,y:this.currentPos.y,w:this.mousePos.x-this.currentPos.x,h:this.mousePos.y-this.currentPos.y}},Main.prototype.draw=function(){this.ctx.strokeStyle="#FF0000";for(var i=0;i<this.shapes.length;i++){var myShape=this.shapes[i];this.ctx.strokeRect(myShape.x,myShape.y,myShape.w,myShape.h)}this.drawmode&&this.ctx.strokeRect(this.rectangle.x,this.rectangle.y,this.rectangle.w,this.rectangle.h)},Main}(etch.drawing.Stage);MyComponents.Main=Main}(MyComponents||(MyComponents={}))},{}]},{},[1])(1)});